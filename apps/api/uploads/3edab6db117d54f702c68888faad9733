# åšå®¢ç³»ç»Ÿå®‰è£…æŒ‡å—

æœ¬æ–‡æ¡£æä¾›è¯¦ç»†çš„å®‰è£…å’Œé…ç½®è¯´æ˜ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿæ­å»ºè‡ªå·±çš„åšå®¢ç³»ç»Ÿã€‚

## ç›®å½•

- [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
- [å¿«é€Ÿå®‰è£…](#å¿«é€Ÿå®‰è£…)
- [æ‰‹åŠ¨å®‰è£…](#æ‰‹åŠ¨å®‰è£…)
- [Dockeréƒ¨ç½²](#dockeréƒ¨ç½²)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## ç³»ç»Ÿè¦æ±‚

### æœ€ä½è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Linux, macOS, Windows 10+
- **Python**: 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Node.js**: 16 æˆ–æ›´é«˜ç‰ˆæœ¬
- **å†…å­˜**: 2GB RAM
- **å­˜å‚¨**: 1GB å¯ç”¨ç©ºé—´

### æ¨èé…ç½®
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ / CentOS 8+ / macOS 12+
- **Python**: 3.11
- **Node.js**: 18 LTS
- **å†…å­˜**: 4GB RAM
- **å­˜å‚¨**: 5GB å¯ç”¨ç©ºé—´

## å¿«é€Ÿå®‰è£…

### ä½¿ç”¨ä¸€é”®å®‰è£…è„šæœ¬

```bash
# 1. ä¸‹è½½é¡¹ç›®
git clone <repository-url>
cd blog-system

# 2. è¿è¡Œå®‰è£…è„šæœ¬
./deploy.sh install

# 3. å¯åŠ¨æœåŠ¡
./deploy.sh start
```

å®‰è£…å®Œæˆåï¼Œè®¿é—®ï¼š
- å‰ç«¯åšå®¢: http://localhost:5174
- ç®¡ç†åå°: http://localhost:5175
- é»˜è®¤è´¦æˆ·: admin / admin123

## æ‰‹åŠ¨å®‰è£…

### 1. ç¯å¢ƒå‡†å¤‡

#### å®‰è£…Python 3.8+
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install python3 python3-pip python3-venv

# CentOS/RHEL
sudo yum install python3 python3-pip

# macOS (ä½¿ç”¨Homebrew)
brew install python@3.11
```

#### å®‰è£…Node.js 16+
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# CentOS/RHEL
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs

# macOS (ä½¿ç”¨Homebrew)
brew install node@18
```

### 2. åç«¯å®‰è£…

```bash
# è¿›å…¥åç«¯ç›®å½•
cd blog_backend

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Linux/macOS
source venv/bin/activate
# Windows
venv\Scripts\activate

# å‡çº§pip
pip install --upgrade pip

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆå§‹åŒ–æ•°æ®åº“
python -c "
from src.main import app
from src.models.blog_models import db
with app.app_context():
    db.create_all()
    print('æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ')
"

# åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
python -c "
from src.main import app
from src.models.blog_models import db, User
from werkzeug.security import generate_password_hash

with app.app_context():
    admin = User(
        username='admin',
        email='admin@example.com',
        password_hash=generate_password_hash('admin123'),
        display_name='ç®¡ç†å‘˜',
        role='admin',
        is_active=True
    )
    db.session.add(admin)
    db.session.commit()
    print('ç®¡ç†å‘˜ç”¨æˆ·åˆ›å»ºæˆåŠŸï¼')
"

# å¯åŠ¨åç«¯æœåŠ¡
python src/main.py
```

### 3. å‰ç«¯å®‰è£…

```bash
# æ–°å¼€ç»ˆç«¯ï¼Œè¿›å…¥å‰ç«¯ç›®å½•
cd blog_frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### 4. ç®¡ç†åå°å®‰è£…

```bash
# æ–°å¼€ç»ˆç«¯ï¼Œè¿›å…¥ç®¡ç†åå°ç›®å½•
cd blog_admin

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

## Dockeréƒ¨ç½²

### ä½¿ç”¨Docker Compose

```bash
# 1. ç¡®ä¿å·²å®‰è£…Dockerå’ŒDocker Compose
docker --version
docker-compose --version

# 2. æ„å»ºå¹¶å¯åŠ¨æœåŠ¡
docker-compose up -d

# 3. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# 5. åœæ­¢æœåŠ¡
docker-compose down
```

### å•ç‹¬æ„å»ºé•œåƒ

```bash
# æ„å»ºåç«¯é•œåƒ
cd blog_backend
docker build -t blog-backend .

# æ„å»ºå‰ç«¯é•œåƒ
cd ../blog_frontend
docker build -t blog-frontend .

# æ„å»ºç®¡ç†åå°é•œåƒ
cd ../blog_admin
docker build -t blog-admin .

# è¿è¡Œå®¹å™¨
docker run -d -p 5000:5000 --name backend blog-backend
docker run -d -p 5174:80 --name frontend blog-frontend
docker run -d -p 5175:80 --name admin blog-admin
```

## é…ç½®è¯´æ˜

### åç«¯é…ç½®

ç¼–è¾‘ `blog_backend/config.py`:

```python
class Config:
    # æ•°æ®åº“é…ç½®
    SQLALCHEMY_DATABASE_URI = 'sqlite:///blog.db'  # æˆ–ä½¿ç”¨MySQL/PostgreSQL
    
    # JWTé…ç½®
    JWT_SECRET_KEY = 'your-secret-key'  # ç”Ÿäº§ç¯å¢ƒè¯·æ›´æ”¹
    JWT_ACCESS_TOKEN_EXPIRES = timedelta(hours=24)
    
    # æ–‡ä»¶ä¸Šä¼ é…ç½®
    UPLOAD_FOLDER = 'uploads'
    MAX_CONTENT_LENGTH = 16 * 1024 * 1024  # 16MB
    
    # CORSé…ç½®
    CORS_ORIGINS = ['http://localhost:5174', 'http://localhost:5175']
```

### å‰ç«¯é…ç½®

ç¼–è¾‘ `blog_frontend/src/lib/api.js`:

```javascript
const API_BASE_URL = 'http://localhost:5000/api/v1';
```

### ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# åç«¯é…ç½®
FLASK_ENV=development
SECRET_KEY=your-secret-key
JWT_SECRET_KEY=your-jwt-secret-key
DATABASE_URL=sqlite:///blog.db

# å‰ç«¯é…ç½®
REACT_APP_API_URL=http://localhost:5000/api/v1
REACT_APP_SITE_NAME=æˆ‘çš„åšå®¢
```

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. åç«¯ç”Ÿäº§éƒ¨ç½²

```bash
# å®‰è£…Gunicorn
pip install gunicorn

# ä½¿ç”¨Gunicornå¯åŠ¨
gunicorn -w 4 -b 0.0.0.0:5000 src.main:app

# æˆ–ä½¿ç”¨systemdæœåŠ¡
sudo cp blog-backend.service /etc/systemd/system/
sudo systemctl enable blog-backend
sudo systemctl start blog-backend
```

### 2. å‰ç«¯ç”Ÿäº§éƒ¨ç½²

```bash
# æ„å»ºå‰ç«¯
cd blog_frontend
npm run build

# éƒ¨ç½²åˆ°Nginx
sudo cp -r dist/* /var/www/html/

# é…ç½®Nginx
sudo cp nginx.conf /etc/nginx/sites-available/blog
sudo ln -s /etc/nginx/sites-available/blog /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### 3. ä½¿ç”¨åå‘ä»£ç†

Nginxé…ç½®ç¤ºä¾‹ï¼š

```nginx
server {
    listen 80;
    server_name yourdomain.com;

    # å‰ç«¯
    location / {
        root /var/www/html;
        try_files $uri $uri/ /index.html;
    }

    # APIä»£ç†
    location /api/ {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # ç®¡ç†åå°
    location /admin/ {
        alias /var/www/admin/;
        try_files $uri $uri/ /admin/index.html;
    }
}
```

## æ•°æ®åº“é…ç½®

### SQLite (é»˜è®¤)
```python
SQLALCHEMY_DATABASE_URI = 'sqlite:///blog.db'
```

### MySQL
```python
SQLALCHEMY_DATABASE_URI = 'mysql://username:password@localhost/blog_db'
```

### PostgreSQL
```python
SQLALCHEMY_DATABASE_URI = 'postgresql://username:password@localhost/blog_db'
```

## å¸¸è§é—®é¢˜

### Q: ç«¯å£è¢«å ç”¨æ€ä¹ˆåŠï¼Ÿ
A: ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£å·ï¼Œæˆ–ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥æ‰¾å¹¶ç»ˆæ­¢å ç”¨è¿›ç¨‹ï¼š
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :5000
# ç»ˆæ­¢è¿›ç¨‹
kill -9 <PID>
```

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ
A: æ£€æŸ¥æ•°æ®åº“é…ç½®å’Œæƒé™ï¼š
```bash
# æ£€æŸ¥SQLiteæ–‡ä»¶æƒé™
ls -la blog.db
# ä¿®æ”¹æƒé™
chmod 664 blog.db
```

### Q: å‰ç«¯æ— æ³•è¿æ¥åç«¯APIï¼Ÿ
A: æ£€æŸ¥CORSé…ç½®å’ŒAPIåœ°å€ï¼š
1. ç¡®è®¤åç«¯CORS_ORIGINSåŒ…å«å‰ç«¯åœ°å€
2. æ£€æŸ¥å‰ç«¯API_BASE_URLé…ç½®
3. ç¡®è®¤é˜²ç«å¢™è®¾ç½®

### Q: ç®¡ç†å‘˜ç™»å½•å¤±è´¥ï¼Ÿ
A: é‡ç½®ç®¡ç†å‘˜å¯†ç ï¼š
```bash
python -c "
from src.main import app
from src.models.blog_models import db, User
from werkzeug.security import generate_password_hash

with app.app_context():
    admin = User.query.filter_by(username='admin').first()
    if admin:
        admin.password_hash = generate_password_hash('new_password')
        db.session.commit()
        print('å¯†ç é‡ç½®æˆåŠŸ')
"
```

### Q: æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼Ÿ
A: æ£€æŸ¥ä¸Šä¼ ç›®å½•æƒé™ï¼š
```bash
# åˆ›å»ºä¸Šä¼ ç›®å½•
mkdir -p uploads
# è®¾ç½®æƒé™
chmod 755 uploads
```

### Q: æœåŠ¡å¯åŠ¨åæ— æ³•è®¿é—®ï¼Ÿ
A: æ£€æŸ¥é˜²ç«å¢™å’Œç«¯å£ï¼š
```bash
# Ubuntu/Debian
sudo ufw allow 5000
sudo ufw allow 5174
sudo ufw allow 5175

# CentOS/RHEL
sudo firewall-cmd --permanent --add-port=5000/tcp
sudo firewall-cmd --permanent --add-port=5174/tcp
sudo firewall-cmd --permanent --add-port=5175/tcp
sudo firewall-cmd --reload
```

## æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–
- ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± 
- æ·»åŠ é€‚å½“çš„ç´¢å¼•
- å®šæœŸæ¸…ç†æ—¥å¿—

### 2. å‰ç«¯ä¼˜åŒ–
- å¯ç”¨Gzipå‹ç¼©
- ä½¿ç”¨CDNåŠ é€Ÿ
- å›¾ç‰‡æ‡’åŠ è½½

### 3. ç¼“å­˜é…ç½®
- Redisç¼“å­˜
- æµè§ˆå™¨ç¼“å­˜
- APIå“åº”ç¼“å­˜

## å¤‡ä»½å’Œæ¢å¤

### æ•°æ®å¤‡ä»½
```bash
# SQLiteå¤‡ä»½
cp blog.db blog_backup_$(date +%Y%m%d).db

# MySQLå¤‡ä»½
mysqldump -u username -p blog_db > blog_backup_$(date +%Y%m%d).sql
```

### æ•°æ®æ¢å¤
```bash
# SQLiteæ¢å¤
cp blog_backup_20231201.db blog.db

# MySQLæ¢å¤
mysql -u username -p blog_db < blog_backup_20231201.sql
```

## ç›‘æ§å’Œæ—¥å¿—

### æ—¥å¿—é…ç½®
```python
import logging
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s %(levelname)s %(message)s',
    handlers=[
        logging.FileHandler('app.log'),
        logging.StreamHandler()
    ]
)
```

### ç›‘æ§å·¥å…·
- ä½¿ç”¨PM2ç®¡ç†Node.jsè¿›ç¨‹
- ä½¿ç”¨Supervisorç®¡ç†Pythonè¿›ç¨‹
- é…ç½®æ—¥å¿—è½®è½¬

## å®‰å…¨å»ºè®®

1. **æ›´æ”¹é»˜è®¤å¯†ç **: ç«‹å³æ›´æ”¹adminé»˜è®¤å¯†ç 
2. **ä½¿ç”¨HTTPS**: ç”Ÿäº§ç¯å¢ƒå¯ç”¨SSL/TLS
3. **å®šæœŸæ›´æ–°**: ä¿æŒä¾èµ–åŒ…æœ€æ–°ç‰ˆæœ¬
4. **å¤‡ä»½æ•°æ®**: å®šæœŸå¤‡ä»½æ•°æ®åº“å’Œæ–‡ä»¶
5. **ç›‘æ§æ—¥å¿—**: å®šæœŸæ£€æŸ¥é”™è¯¯æ—¥å¿—
6. **é™åˆ¶è®¿é—®**: é…ç½®é˜²ç«å¢™å’Œè®¿é—®æ§åˆ¶

## è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
2. æ£€æŸ¥é…ç½®æ–‡ä»¶
3. å‚è€ƒå¸¸è§é—®é¢˜
4. æäº¤Issueåˆ°é¡¹ç›®ä»“åº“

---

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰

